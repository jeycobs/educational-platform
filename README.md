# Образовательная Платформа (EduPlatform)

Это веб-приложение представляет собой прототип образовательной платформы, разработанный на FastAPI. Платформа позволяет студентам искать курсы, просматривать материалы и отслеживать свой прогресс. Для преподавателей и администраторов предусмотрены функции создания контента и аналитики.

Ключевой особенностью является сбор данных об активности студентов для последующего анализа и построения рекомендательных систем.

## Основные возможности

- **Аутентификация пользователей:** Регистрация и вход по JWT-токенам. Роли: студент, преподаватель, администратор.
- **Каталог курсов:** Просмотр курсов и их детальной информации.
- **Мощный поиск:** Полнотекстовый поиск по курсам, учебным материалам и преподавателям с использованием Whoosh. Поддерживаются фильтры по категориям, уровню сложности и другим параметрам.
- **Панель управления (Dashboard):** Персональная страница для каждого пользователя, где отображается профиль, список курсов, прогресс обучения и недавняя активность.
- **Сбор данных:** Система логирует действия студентов (просмотр материалов, прохождение тестов) в базу данных.
- **ETL-пайплайн:** Специальные эндпоинты для извлечения, преобразования и загрузки (ETL) данных об активности студентов, готовых для анализа и использования в ML-моделях.
- **Административные функции:** Возможность полной переиндексации поискового движка.
- **Автоматическая документация API:** Интерактивная документация Swagger UI и ReDoc.

## Технологический стек

- **Бэкенд:** Python, FastAPI, SQLAlchemy (с асинхронным драйвером для SQLite), Whoosh.
- **База данных:** SQLite.
- **Фронтенд:** HTML5, CSS3, JavaScript (Vanilla JS), Bootstrap 5.
- **Сервер:** Uvicorn (ASGI).

## Установка и запуск

Следуйте этим шагам, чтобы запустить проект на вашем локальном компьютере.

### 1. Клонирование репозитория

```bash
git clone https://github.com/jeycobs/educational-platform
cd educational-platform
```

### 2. Создание виртуального окружения

Рекомендуется использовать виртуальное окружение, чтобы изолировать зависимости проекта.

- **На macOS / Linux:**
  ```bash
  python3 -m venv venv
  source venv/bin/activate
  ```

- **На Windows:**
  ```bash
  python -m venv venv
  .\venv\Scripts\activate
  ```

### 3. Установка зависимостей

Установите все необходимые библиотеки из файла `requirements.txt`:

```bash
pip install -r requirements.txt
```

### 4. Инициализация базы данных и поискового индекса

Перед первым запуском необходимо создать базу данных и заполнить ее тестовыми данными. Скрипт `init_db.py` также автоматически наполнит поисковый индекс Whoosh.

```bash
python init_db.py
```
Этот скрипт выполнит следующие действия:
1. Удалит старый файл базы данных `db.sqlite3` (если он существует).
2. Создаст все таблицы в соответствии с моделями в `db.py`.
3. Заполнит таблицы тестовыми данными (пользователи, курсы, материалы, активности).
4. **Проиндексирует все созданные данные** для поискового движка.

### 5. Запуск сервера

Теперь вы готовы запустить веб-сервер FastAPI:

```bash
uvicorn main:app --reload
```
- Флаг `--reload` автоматически перезапускает сервер при изменении кода.

Сервер будет доступен по адресу: [http://127.0.0.1:8000](http://127.0.0.1:8000)

## Как использовать платформу

### Вход и регистрация
- Откройте [http://127.0.0.1:8000](http://127.0.0.1:8000) в браузере.
- Вы можете зарегистрировать нового пользователя или использовать тестовые аккаунты.

**Тестовые пользователи (пароль для всех: `testpassword`):**
- **Студент:** `anna.student@example.com`
- **Преподаватель:** `ivan.genius@example.com`
- **Администратор:** `maria.admin@example.com`

### Панель управления (Dashboard)
- После входа вы будете перенаправлены на [http://127.0.0.1:8000/dashboard](http://127.0.0.1:8000/dashboard).
- Здесь вы можете просматривать свой профиль, курсы, а также вкладки **"Мой прогресс"** и **"Моя активность"**.

---

## Документация и администрирование API (Swagger UI)

FastAPI автоматически генерирует интерактивную документацию для всех эндпоинтов. Это мощный инструмент для тестирования и изучения API.

**Адрес документации:** [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)

### Тестирование поиска

Вы можете протестировать поиск напрямую через API:
1.  Откройте раздел `Search` и эндпоинт `GET /search`.
2.  Нажмите "Try it out".
3.  Введите параметры, например, в поле `q` напишите `Python`.
4.  Нажмите "Execute", чтобы увидеть результат.

### Полная переиндексация (для администратора) (ОБЯЗАТЕЛЬНО ПРИ ПЕРВОНАЧАЛЬНОЙ УСТАНОВКЕ))

Иногда может потребоваться полностью синхронизировать поисковый индекс с основной базой данных (например, после ручного изменения данных в БД). Для этого существует специальный эндпоинт.

1.  **Авторизуйтесь как администратор:**
    - Нажмите на зеленую кнопку **"Authorize"** в правом верхнем углу страницы `/docs`.
    - Введите логин **`maria.admin@example.com`** и пароль **`testpassword`**.
    - Нажмите **"Authorize"** и закройте окно.

2.  **Запустите переиндексацию:**
    - Найдите раздел `Admin` и эндпоинт `POST /admin/search/reindex-all`.
    - Нажмите "Try it out", а затем "Execute".
    - Это сотрет старый индекс и создаст новый на основе всех данных из базы.

---

### Запуск ETL-пайплайна
Для извлечения подготовленных данных для анализа выполните скрипт `run_etl.py`:

```bash
python run_etl.py
```
Этот скрипт:
1. Авторизуется под администратором.
2. Делает запросы к ETL-эндпоинтам (`/etl/...`).
3. Сохраняет полученные данные в папку `data_pipeline_output` в форматах `.json` и `.csv`.


## Структура проекта

```
.
├── data_pipeline_output/ # Папка для результатов ETL
├── static/               # Статические файлы
│   ├── css/custom.css
│   └── js/app.js
├── templates/            # HTML-шаблоны
│   ├── includes/         # Переиспользуемые части шаблонов
│   ├── base.html
│   └── ...
├── whoosh_platform_index/ # Индексы для поискового движка
├── db.py                 # Модели SQLAlchemy
├── fill_test_data.py     # Скрипт для заполнения БД и индексации
├── init_db.py            # Скрипт для инициализации БД
├── main.py               # Основной файл FastAPI-приложения
├── run_etl.py            # Скрипт для запуска ETL
├── search_service.py     # Логика поиска Whoosh
└── requirements.txt      # Зависимости проекта
```
